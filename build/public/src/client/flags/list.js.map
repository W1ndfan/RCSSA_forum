{"version":3,"sources":["public/src/client/flags/list.js"],"names":["define","components","Chart","Flags","init","enableFilterForm","enableChatButtons","handleGraphs","filtersEl","get","filter","ajaxify","data","filters","hasOwnProperty","find","val","on","payload","serializeArray","item","value","go","length","$","param","app","newChat","this","getAttribute","dailyCanvas","document","getElementById","dailyLabels","utils","getDaysArray","map","text","idx","isMobile","defaults","global","tooltips","enabled","flags:daily","labels","datasets","label","backgroundColor","borderColor","pointBackgroundColor","pointHoverBackgroundColor","pointBorderColor","pointHoverBorderColor","analytics","width","parent","getContext","type","options","responsive","animation","legend","display","scales","yAxes","ticks","beginAtZero","precision"],"mappings":"AAAA,aAEAA,OAAO,oBAAqB,aAAc,SAAU,SAAUC,EAAYC,GACzE,IAAIC,KAEJA,EAAMC,KAAO,WACZD,EAAME,mBACNF,EAAMG,oBACNH,EAAMI,gBAGPJ,EAAME,iBAAmB,WACxB,IAAIG,EAAYP,EAAWQ,IAAI,iBAG/B,IAAK,IAAIC,KAAUC,QAAQC,KAAKC,QAAS,CACxC,GAAIF,QAAQC,KAAKC,QAAQC,eAAeJ,GAAS,CAChDF,EAAUO,KAAK,UAAYL,EAAS,MAAMM,IAAIL,QAAQC,KAAKC,QAAQH,KAIrEF,EAAUO,KAAK,UAAUE,GAAG,QAAS,WACpC,IAAIC,EAAUV,EAAUW,iBAAiBT,OAAO,SAAUU,GACzD,QAASA,EAAKC,QAEfV,QAAQW,GAAG,UAAYJ,EAAQK,OAASC,EAAEC,MAAMP,GAAW,eAI7Df,EAAMG,kBAAoB,WACzBkB,EAAE,eAAeP,GAAG,QAAS,WAC5BS,IAAIC,QAAQC,KAAKC,aAAa,iBAIhC1B,EAAMI,aAAe,WACpB,IAAIuB,EAAcC,SAASC,eAAe,eAC1C,IAAIC,EAAcC,MAAMC,eAAeC,IAAI,SAAUC,EAAMC,GAC1D,OAAOA,EAAM,EAAI,GAAKD,IAGvB,GAAIH,MAAMK,WAAY,CACrBrC,EAAMsC,SAASC,OAAOC,SAASC,QAAU,MAE1C,IAAI/B,GACHgC,eACCC,OAAQZ,EACRa,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBzC,KAAMD,QAAQC,KAAK0C,cAMvBxB,EAAYyB,MAAQ/B,EAAEM,GAAa0B,SAASD,QAC5C,IAAIrD,EAAM4B,EAAY2B,WAAW,OAChCC,KAAM,OACN9C,KAAMA,EAAK,eACX+C,SACCC,WAAY,KACZC,UAAW,MACXC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,KACbC,UAAW,UAQjB,OAAOjE","file":"public/src/client/flags/list.js","sourcesContent":["'use strict';\r\n\r\ndefine('forum/flags/list', ['components', 'Chart'], function (components, Chart) {\r\n\tvar Flags = {};\r\n\r\n\tFlags.init = function () {\r\n\t\tFlags.enableFilterForm();\r\n\t\tFlags.enableChatButtons();\r\n\t\tFlags.handleGraphs();\r\n\t};\r\n\r\n\tFlags.enableFilterForm = function () {\r\n\t\tvar filtersEl = components.get('flags/filters');\r\n\r\n\t\t// Parse ajaxify data to set form values to reflect current filters\r\n\t\tfor (var filter in ajaxify.data.filters) {\r\n\t\t\tif (ajaxify.data.filters.hasOwnProperty(filter)) {\r\n\t\t\t\tfiltersEl.find('[name=\"' + filter + '\"]').val(ajaxify.data.filters[filter]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfiltersEl.find('button').on('click', function () {\r\n\t\t\tvar payload = filtersEl.serializeArray().filter(function (item) {\r\n\t\t\t\treturn !!item.value;\r\n\t\t\t});\r\n\t\t\tajaxify.go('flags?' + (payload.length ? $.param(payload) : 'reset=1'));\r\n\t\t});\r\n\t};\r\n\r\n\tFlags.enableChatButtons = function () {\r\n\t\t$('[data-chat]').on('click', function () {\r\n\t\t\tapp.newChat(this.getAttribute('data-chat'));\r\n\t\t});\r\n\t};\r\n\r\n\tFlags.handleGraphs = function () {\r\n\t\tvar dailyCanvas = document.getElementById('flags:daily');\r\n\t\tvar dailyLabels = utils.getDaysArray().map(function (text, idx) {\r\n\t\t\treturn idx % 3 ? '' : text;\r\n\t\t});\r\n\r\n\t\tif (utils.isMobile()) {\r\n\t\t\tChart.defaults.global.tooltips.enabled = false;\r\n\t\t}\r\n\t\tvar data = {\r\n\t\t\t'flags:daily': {\r\n\t\t\t\tlabels: dailyLabels,\r\n\t\t\t\tdatasets: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: '',\r\n\t\t\t\t\t\tbackgroundColor: 'rgba(151,187,205,0.2)',\r\n\t\t\t\t\t\tborderColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\r\n\t\t\t\t\t\tpointBorderColor: '#fff',\r\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(151,187,205,1)',\r\n\t\t\t\t\t\tdata: ajaxify.data.analytics,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tdailyCanvas.width = $(dailyCanvas).parent().width();\r\n\t\tnew Chart(dailyCanvas.getContext('2d'), {\r\n\t\t\ttype: 'line',\r\n\t\t\tdata: data['flags:daily'],\r\n\t\t\toptions: {\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tanimation: false,\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tdisplay: false,\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t\tyAxes: [{\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tbeginAtZero: true,\r\n\t\t\t\t\t\t\tprecision: 0,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\treturn Flags;\r\n});\r\n"]}